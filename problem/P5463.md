# 小鱼比可爱（加强版）

## 题目背景



## 题目描述

人比人，气死人；鱼比鱼，难死鱼。小鱼最近参加了一个“比可爱”比赛，比的是每只鱼的可爱程度。参赛的鱼被从左到右排成一排，头都朝向左边，然后每只鱼会得到一个整数数值，表示这只鱼的可爱程度，很显然整数越大，表示这只鱼越可爱，而且任意两只鱼的可爱程度可能一样。由于所有的鱼头都朝向左边，所以每只鱼只能看见在它左边的鱼的可爱程度，它们心里都在计算，在自己的眼力范围内有多少只鱼不如自己可爱呢。请你帮这些可爱但是鱼脑不够用的小鱼们计算一下。

和之前的要求不一样，比赛组委会关心的是这个排列的“总得意值”。一共有 $n$ 只小鱼，总共有 $\frac{n(n+1)}2$ 个不同的区间。每个区间的得意值等于这个区间中符合“左边的一只鱼的可爱值比右边的一只鱼可爱值更大”的对数（其实就是区间逆序对数啦）。总得意值就是所有区间的“得意值”的和。现在要求输出“总得意值”是多少。

## 输入格式

第一行输入一个整数 $n$，表示鱼的数目。

第二行内输入 $n$ 个整数 $a_1,a_2,\cdots,a_n$，用空格间隔，依次表示从左到右每只小鱼的可爱程度。

## 输出格式

输出一个整数表示答案。

## 样例 #1

### 样例输入 #1
```
8
1 9 2 6 0 8 1 7```

### 样例输出 #1

```
106```

## 样例 #2

### 样例输入 #2
```
10
1 10 8 5 6 2 3 9 4 7```

### 样例输出 #2

```
270```

## 样例 #3

### 样例输入 #3
```
20
6 0 4 5 8 8 0 6 6 1 0 4 6 6 0 0 7 2 0 5```

### 样例输出 #3

```
3481```

## 提示

测试点　　　|$n$　　　　|$a_i$　　　　|是否有重复数字 　
:-:|:-:|:-:|:-:
$1$|$1$|无特殊限制|否
$2$|$10$|无特殊限制|否
$3$|$10$|无特殊限制|是
$4$|$1000$|$\le10$|是
$5$|$1000$|无特殊限制|否
$6$|$1000$|无特殊限制|是
$7$|$10^5$|$\le100$|是
$8$|$3\times 10^5$|无特殊限制|否
$9$|$5\times 10^5$|无特殊限制|是
$10$|$10^6$|无特殊限制|是

对于 $100\%$ 的数据，$n \le 10^6$，$a_i\le 10^9$，所有数字均为非负整数。
