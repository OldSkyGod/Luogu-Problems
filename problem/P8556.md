# 心跳 加强版

## 题目背景

本题为 [洛谷 9 月月赛 II & NR I. E. 心跳](/problem/P8554) 的加强版，唯一的区别在于数据范围改为 $n \le 5 \times {10}^6$。

---

“清晰的跳动声传达来的，重叠的声响和流动的思念。

约定再也不要分开吧，希望无论何时都不要让你寂寞。”

恋爱之时，人的心情不会一成不变，可喜悦和悲伤会随着时间流逝而归于平淡。最令人难忘的是那些“心动”的感觉，那些因未曾经历而喜出望外的感觉。因此，有些时候，失去某些特别美好的回忆，反而能让心动的感觉增多。可为此失去那些回忆，真的值得吗？

## 题目描述

赫尔德想对上面的问题进行探究，她想先做一些统计，于是她抽象了这个问题。

我们对于一个长为 $l$ 的数列 $p$，定义函数：

-   $f(p)$ 表示有多少 $1\le i\le l$ 满足 $p_i=\max_{j=1}^i p_j$（即前缀最大值的个数）。

现在，给定 $n,m$，请求出有多少满足以下条件的长为 $n$ 的，值域在 $[m,n]$ 数列 $a$：

-   存在一个排列 $p$ 使得：令 $P_i$ 代表 $p$ 去掉 $p_i$ 后的数列（即 $[p_1,p_2,\dots,p_{i-1},p_{i+1},\dots,p_n]$），$f(P_i)=a_i$。

答案对 $10^9+7$ 取模。

## 输入格式

一行两个正整数表示 $n,m$。

## 输出格式

一行一个数，表示答案。

## 样例 #1

### 样例输入 #1
```
3 1
```

### 样例输出 #1

```
6
```

## 样例 #2

### 样例输入 #2
```
5 3
```

### 样例输出 #2

```
8
```

## 样例 #3

### 样例输入 #3
```
500000 100000
```

### 样例输出 #3

```
226048544
```

## 提示

**【样例解释 \#2】**

有以下 $8$ 种不同的 $a$：

1. $\{4,4,4,4,4\}$，对应的一种 $p$ 为：$\{1,2,3,4,5\}$；
2. $\{3,3,3,4,4\}$，对应的一种 $p$ 为：$\{1,2,3,5,4\}$；
3. $\{3,3,4,4,3\}$，对应的一种 $p$ 为：$\{1,2,4,3,5\}$；
4. $\{3,3,3,3,4\}$，对应的一种 $p$ 为：$\{1,2,4,5,3\}$；
5. $\{3,4,4,3,3\}$，对应的一种 $p$ 为：$\{1,3,2,4,5\}$；
6. $\{3,3,3,4,3\}$，对应的一种 $p$ 为：$\{1,3,4,2,5\}$；
7. $\{4,4,3,3,3\}$，对应的一种 $p$ 为：$\{2,1,3,4,5\}$；
8. $\{3,3,4,3,3\}$，对应的一种 $p$ 为：$\{2,3,1,4,5\}$。

---

**【数据范围】**

对于所有数据，保证 $1 \le m < n \le 5 \times {10}^6$。

---

赫尔德成功算出了不同的恋爱的数量。但她只会经历其中一个。
