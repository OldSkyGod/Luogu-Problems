# [Ynoi Easy Round 2022] 虚空处刑

## 题目背景

我要对不死者先生你施展魔法，希望你能看到，更多美好的事物，希望你能见识到，更多我无法见识的事物，希望...你的心...不管几次都能苏——

......

你的魔法为时已晚了，和知道没有办法可以救你是一样的，仿佛就像是这什么都没有的天空一样啊——

星星？

![](https://cdn.luogu.com.cn/upload/image_hosting/1q0z7j3z.png)

......

星星呢？有个星形的星星飘在天上？

像那种奇妙的东西啊，是超人机械的产物哦。

......

已不能，继续光顾着追求星星...

不死者的本体的确不见得是在那颗星星上，我也知道他们大多是脱离常轨的危险任务，这些我都明白...

但天上就是飘着那种星星啊，超人机械或许就在上面，史前的睿智肯定堆积如山。

......

星形的理由是个迷，也看不出任何工学上的必然性。但他若是以自然物为基础打造的，那这形状就说得通了。

正确来说，我认为那是个群体，而不是单一生命体，且若它是生物，那就可预想它有着机械所没有的优点，像是自然修复损毁部位，透过增殖解决经年老化问题，甚至可能是以不需管理者为前提所打造的。

目前我们还不理解它是用什么系统来维持飞行轨道，但高度应该是最佳环境不会错。

连次元的墙壁都能跨越的超绝知性体，怎么可能将与自身相关的重要机构，放在区区三万六千公里高的天空上？

你不觉得魔法是个很极端的东西吗？光用想的就能产生出热或质量，这实在太荒唐了，超越人智，犹如神般的存在姑且先不谈，一个小小的生命，人类的亚种，魔法使们怎么可能会有如此强大的力量？

魔法使换句话说就是水龙头，水源则是另在别处。

星星是超人机械所撒下的，供应魔力与抑制魔法的生命机器，除此以外可能什么都不是吧。

......

我们已经不做星星的梦了。

魔法产生的原理，一旦被世人知道，就会引发末日战争。现在我们只能尽全力透过操控情报，让世人不对此事感兴趣。

## 题目描述

给定一棵 $n$ 个节点的树，第 $i$ 个点有点权 $a_i$。

定义一个点 $x$ 所在的极大同色连通块为一个**极大的**点集 $S$，满足 $x\in S$，且对任意点集中的元素 $i,j$，可以找到一个节点序列 $p_1,p_2,...p_t$，满足 $p_1=i$，$p_t=j$，且对任意 $k$ 为 $[1,t)$ 中的整数，满足 $p_k$ 与 $p_{k+1}$ 在树上相邻，且 $a_{p_k}=a_{p_{k+1}}$，且 $p_k\in S$。

有 $m$ 次操作：

`1 x y`：给出一个点 $x$ ，将其所在的极大同色连通块中每个点的点权修改为 $y$。

`2 x`：给出一个点 $x$，查询其所在的极大同色连通块的大小。

## 输入格式

第一行两个数 $n,m$。

第二行 $n-1$ 个数，第 $i$ 个数表示树上第 $i+1$ 的节点的父亲节点的编号，保证父亲节点的编号比该节点小。

第三行 $n$ 个数，第 $i$ 个数表示 $a_i$。

之后 $m$ 行，每行形如 `1 x y` 或 `2 x`，意义如上述。

## 输出格式

对每个 $2$ 操作，输出一行一个数表示答案。

## 样例 #1

### 样例输入 #1
```
4 5
1 1 2
3 1 1 1
2 4
1 1 1
1 4 3
2 4
1 3 3```

### 样例输出 #1

```
2
4```

## 提示

Idea：nzhtl1477，Solution：nzhtl1477，Code：ccz181078，Data：ccz181078

对于 $20\%$ 的数据，满足 $n,m\leq2\times 10^3$。

对于 $40\%$ 的数据，满足 $n,m\leq2\times 10^5$。

对于另外 $30\%$ 的数据，满足 $1\le a_i,y\le 2$。

对于 $100\%$ 的数据，满足 $1\le n,m,a_i,x,y\le10^6$。
