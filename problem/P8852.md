# [JRKSJ R5] Concvssion

## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/no6azjmn.png?x-oss-process=image)

你很喜欢 Concvssion，但这并不妨碍你来做一道并不困难的有趣题目。

（题目背景图片来自 Phigros 曲绘，如有侵权，请告知出题人。）

## 题目描述

给定长度为 $n$ 的序列 $a,b$，满足 $\forall i\in[1,n],a_i,b_i\in[1,n]$。

定义一次操作为，$\forall i\in[1,n],b_i\gets a_{b_i}$。

你需要依次进行 $n$ 次操作，每次操作后求出 $\displaystyle\sum_{i=1}^n b_i$ 对 $998244353$ 取模的答案。

## 输入格式

第一行一个整数 $n$。\
第二行 $n$ 个整数表示 $a$。\
第三行 $n$ 个整数表示 $b$。

## 输出格式

共 $n$ 行，每行一个整数表示答案，答案对 $998244353$ 取模。

## 样例 #1

### 样例输入 #1
```
5
2 3 4 5 1
2 2 3 1 1```

### 样例输出 #1

```
14
19
19
14
9```

## 样例 #2

### 样例输入 #2
```
5
3 5 1 4 2
2 2 3 1 1```

### 样例输出 #2

```
17
9
17
9
17```

## 样例 #3

### 样例输入 #3
```
5
1 1 2 2 4
2 2 3 1 1```

### 样例输出 #3

```
6
5
5
5
5```

## 样例 #4

### 样例输入 #4
```
5
3 1 5 3 4
2 2 1 3 3```

### 样例输出 #4

```
15
19
20
21
19```

## 提示

Idea：cyffff，Solution：Ntokisq&WhisperingSnowflakes，Code：cyffff&WhisperingSnowflakes，Data：cyffff

**Concvssion - Halv (Insane15.5)**
### 数据规模
本题采用捆绑测试。

| $\text{Subtask}$ | $n\le$ | 特殊限制 | $\text{Score}$ |
| :----------: | :----------: | :----------: | :----------: |
| $1$ | $10^4$ | 无 | $10$ |
| $2$ | $10^5$ | $\forall i\in[1,n],a_i\le10^3$ | $10$ |
| $3$ | $10^5$ | $\forall i\in[1,n],a_i=i\bmod n+1$ | $10$ |
| $4$ | $10^5$ | $a$ 是一个 $[1,n]$ 的排列 | $15$ |
| $5$ | $10^5$ | $a_1=1,\forall i\in[2,n],a_i< i$ | $25$ |
| $6$ | $10^5$ | 无 | $20$ |
| $7$ | $3\times10^5$ | 无 | $10$ |

对于 $100\%$ 的数据，$1\le a_i,b_i\le n\le 3\times10^5$。
### 特殊评分方式
本题开启子任务依赖，具体如下：
- 对于子任务 $i\in\{1,2,3,5\}$，您只需答对子任务 $i$ 即可获得子任务 $i$ 的分数。
- 对于子任务 $i=4$，您需要答对所有 $j\in[3,4]$ 的子任务 $j$ 才能获得子任务 $i$ 的分数。
- 对于子任务 $i\in\{6,7\}$，您需要答对所有 $j\in[1,i]$ 的子任务 $j$ 才能获得子任务 $i$ 的分数。
