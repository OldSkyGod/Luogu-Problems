# 「Wdsr-3」蓬莱药局

## 题目描述

永琳采用的细菌里的基因可以用一个**有序**数列描述。永琳事先对基因编了号，数列上的基因的编码为 $1$ 到 $k$ 的整数。每种数字代表一种不同的基因。

在培养皿里，所有细菌每分钟就会分裂一次。分裂时，一个细菌会变成两个细菌，这两个细菌所包含的基因与被分裂的那个细菌**完全一致**。假设分裂前培养皿中的细菌个数为 $C$，则分裂后培养皿中会存在 $2C$ 个细菌。

每次分裂完成后，永琳会使用某些手段让培养皿中当前存在的**所有**细菌都会进行一次基因突变。记一次「基因突变」为 $f(X)$，其中 $X$ 为要突变的细菌的基因序列。基因突变会作用于 $X$ 中的**每一项**，若这个数字为 $c$，则在变换结束后这个位置的数字有 $P_{c,1}$ 的概率为 $1$，$P_{c,2}$ 的概率为 $2$，$\cdots$，$P_{c,k}$ 的概率为 $k$。数据保证 $\forall c \in [1,k], \sum_{i=1}^kP_{c,i}=1$。

永琳需要获取包含特定基因的细菌。具体而言，永琳选定了 $m$ 个特殊的基因**序列** $g_1, g_2 \cdots g_m$。对于每个细菌，统计每个基因序列作为子串出现的数目，如果每个基因序列作为子串出现的数目之和为奇数，那么这就是永琳希望得到的细菌，称作「目标细菌」。

- 我们称长度为 $l$ 的数列 $b$ 是数列 $a$ 的子串，当且仅当存在这样的位置 $p$，使得 $b_1=a_p,b_2=a_{p+1},\cdots,b_l=a_{p+l-1}$。  
- 「数列 $b$ 在数列 $a$ 中作为子串出现的数目」被定义为这样的不同的 $p$ 的总个数。

现在定义 $T(X,t)$ 为，在一个空培养皿中放置一个基因序列为 $X$ 的细菌，$t$ 分钟后培养皿中目标细菌的个数期望。

永琳会给出一个长度为 $n$ 的数字串 $S$ 和一个整数 $t$。请对于 $S$ 的长度为 $1,2,3,\cdots n$ 的前缀 $S[1,1],S[1,2],\cdots,S[1,n]$，分别求出 $T(S[1,i],t)\bmod (10^9+7)$ 的值。



## 输入格式

- 第一行包含四个整数，$n,m,k,t$。  
- 接下来一行，输入 $n$ 个整数 $S_1, S_2, \cdots, S_n$。  
- 接下来 $m$ 行，第 $i$ 行输入 $|g_i|+1$ 个整数。每行第一个数 $|g_i|$ 表示基因序列 $g_i$ 的长度。接下来 $|g_i|$ 个数描述基因序列 $g_i$。  
- 由于 $P$ 矩阵当中的元素都是实数，输入不方便，因此我们采用另一种方式输入 $P$ 矩阵。具体而言，接下来 $k$ 行 $k$ 列描述一个矩阵 $P'$，真正的 $P$ 矩阵如下：

$$P_{i,j}=\dfrac{P'_{i,j}}{\sum_{l=1}^k P'_{i,l}}$$


## 输出格式

- 输出 $n$ 行，每行一个整数。第 $i$ 行的整数代表 $T(S[1,i],t)\bmod (10^9+7)$ 的值。

## 样例 #1

### 样例输入 #1
```
2 2 2 1
1 1
1 1
2 2 2
1 1
1 1
```

### 样例输出 #1

```
1
500000005
```

## 样例 #2

### 样例输入 #2
```
5 5 5 1
1 4 2 3 3
3 1 1 4
3 5 1 4
4 1 4 1 4
2 5 3
1 5
9 9 8 2 4
4 3 5 3 2
1 4 7 4 8
3 6 4 7 1
1 4 5 1 4
```

### 样例输出 #2

```
250000002
273809526
931547626
97163867
377852186
```

## 提示

### 样例解释

#### 样例 \#1

- 当前缀长度为 $1$ 时，细菌的基因序列为 $\{1\}$。分裂一次后变为 $\{1\}$ 和 $\{2\}$ 的概率均为 $\dfrac 1 2$。若变为 $\{1\}$，则是目标细菌；若变为 $\{2\}$，则不是目标细菌。分裂一次后培养皿中有 $2$ 个细菌，故目标细菌总数的期望为 $\dfrac 1 2\times 2=1$。  
![](https://cdn.luogu.com.cn/upload/image_hosting/ytz7qxkl.png)  
- 当前缀长度为 $2$ 时，细菌的基因序列为 $\{1, 1\}$。分裂一次后的细菌变为 $\{1, 1\}, \{1, 2\}, \{2, 1\}, \{2, 2\}$ 的概率都为 $\dfrac 1 4$。其中 $\{2, 2\},\{1,2\},\{2,1\}$ 均为目标细菌，$\{1,1\}$ 不是目标细菌（因为出现了两次子串 $\{1\}$）。即分裂后的目标细菌的总数的期望为 $\dfrac 3 4$。分裂一次后培养皿中有 $2$ 个细菌。即最后目标细菌数量之和的期望为 $\dfrac 3 4\times 2=\dfrac 3 2$。  
![](https://cdn.luogu.com.cn/upload/image_hosting/cjx85fuk.png)

---

### 数据范围

**本题采用捆绑测试，且不存在一个 subtask 包含其他所有 subtask 的数据范围和限制。**



$$
\def{\arraystretch}{1.5}
\begin{array}{|c|c|c|c|c|c|c|c|} \hline
\textbf{subtask} & \textbf{分值} &\bm{n\le} & \bm{m\le} &\bm{k\le}&\bm{t\le} & \bm {|g_i|\le} &  \textbf{特殊性质} \cr \hline
1 & 1 & 10^5 & 10^5 & 100 & 0 & 10^5 \cr \hline
2 & 14 & 5 & 5 & 5 & 1 & 5 \cr \hline
3 & 15 & 10^3 & 1 & 10^3 & 1 & 100 & \text{A} \cr \hline
4 & 30 & 5\times 10^4 & 5 & 10 & 1 & 50 & \text{B} \cr \hline
5 & 20 & 5\times 10^4 & 5 & 10 & 10^3 & 50 \cr \hline
6 & 20 & 10^3 & 10^4 & 10 & 10^3 &  10^4 & \text{C}\cr \hline
\end{array}
$$

**特殊性质** $\textbf{A}$：对于 $i=1,2,\cdots,m$，保证 $g_{i}$ 中只会出现数字 $1$。  
**特殊性质** $\textbf{B}$：对于 $i=1,2,\cdots, k$，$j=1,2,\cdots,k$，保证 $P_{i,j}=1$ 。  
**特殊性质** $\textbf{C}$：保证 $\sum_{i=1}^m |g_i|\le 10^4$。  

对于全部数据，保证 $1\le n,m,\sum|g_i| \le 10^5$。$0\le t\le 10^3$，$0\le P'_{i,j} \le 10^9$。且 $P'$ 矩阵不会出现某一行的和在模 $10^9+7$ 意义下为 $0$。
