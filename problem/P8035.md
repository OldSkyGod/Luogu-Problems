# [COCI2015-2016#7] Otpor

## 题目背景



## 题目描述

众所周知，电阻的连接包括串联和并联两种。而一条电路的所有电阻可以视为这条电路的等效电阻 $R_{ekv}$。当电阻串联时，可以这样表示：

$$\text{(R1-R2-R3-...-RK)}$$

同时满足公式：

$$R_{ekv}=\sum_{i=1}^K R_i$$

并联时可以这样表示：

$$\text{(R1|R2|R3|...|RK)}$$

同时满足公式：

$$R_{ekv}=\frac{1}{\sum_{i=1}^K \frac{1}{R_i}}$$

现有一个包含 $N$ 种阻值为 $R_i$ 的电阻和足够多的导线。给定这些电阻的连接方式，求整条电路的等效电阻值。

## 输入格式

第一行，一个整数 $N$。

第二行，$N$ 个实数 $R_i$。

第三行，一个字符串 $S$，表示电路。字符串只包含 $\texttt R$、$\texttt 1 \sim \texttt 9$、$\texttt ($、$\texttt )$、$\texttt -$ 和 $\texttt |$。数据保证不会有括号不匹配或不合法的现象，同时括号的数量将会最小化。任何一对括号内都不会同时出现 $\texttt -$ 和 $\texttt |$。电路只包含给定的 $N$ 种电阻，且可能出现任意（包括 $0$）次。

## 输出格式

输出整条电路的等效电阻值。输出与标准答案相差不超过 $10^{-5}$ 则视为正确。

## 样例 #1

### 样例输入 #1
```
3
2 3 6
(R1-R2-R3)```

### 样例输出 #1

```
11.00000```

## 样例 #2

### 样例输入 #2
```
3
2 3 6
(R1|R2|R3)```

### 样例输出 #2

```
1.00000```

## 样例 #3

### 样例输入 #3
```
5
5.0 5.0 5.0 5.0 5.0
((R1-(R2|R3)-(R4|R5))|(R1-(R2|R3)-(R4|R5)))```

### 样例输出 #3

```
5.00000```

## 提示

**【数据规模与约定】**

- 对于 $20\%$ 的数据，$N=3$ 且电路恰好包含这三种电阻。
- 对于 $40\%$ 的数据，$S$ 中只包含一对括号。
- 对于 $100\%$ 的数据，$1 \le N \le 9$，$0 \lt R_i \lt 100$，$1 \le |S| \le 10^5$。

**【提示与说明】**

**题目译自 [COCI 2015-2016](https://hsin.hr/coci/archive/2015_2016/) [#7](https://hsin.hr/coci/archive/2015_2016/contest7_tasks.pdf) _Task 4 Otpor_。**

**本题分值按 COCI 原题设置，满分 $120$。**
