# Zoj3229 Shoot the Bullet|东方文花帖|【模板】有源汇上下界最大流

## 题目描述

![](https://i.loli.net/2019/01/12/5c3971b885128.jpg)（附注：文花帖8-8 西行寺幽幽子 「死蝶浮月」）

在接下来的$n$天中，射命丸文将要拍摄幻想乡的少女的照片并且从中为第$x$个少女拍摄至少$G_x$张照片刊登在《文文。新闻》上。在第$k$天的时候文文有$C_k$个取材对象，且对于每个取材对象拍的照片**必须**在闭区间$[L_{k_i},R_{k_i}]$中。如果过少，文文就搞不出大新文；如果过多，就会有少女很安格瑞。

除此之外，因为拍照设备的原因，对于第$i$天，每天的拍照数量不能超过$D_i$张。在满足这些限定的条件下，文文希望拍到的照片尽可能地多。

由于文文需要去取材，因此她把这个任务交给了你，让你帮她去解决。

## 输入格式

本题不定组数据，确保数据组数不超过$10$

第一行输入两个整数$n$和$m$，分别表示有$n$天，有$m$位少女。其中$n \leq 365,m \leq 1000$

接下来一行，有$m$个数字$G_1 \cdots G_m$，对于每一个$G_x$，都满足$G_x \in [0,10^5]$。

再接下来$n$段，每一段的第一行有两个整数$C,D(1 \leq C \leq 300, 0 \leq D \leq 30000)$

接下来有$C$行，每一行有三个整数$T,L,R(0 \leq T < m, 0 \leq L \leq R \leq 100)$，其中$T$指的是少女的编号。

## 输出格式

如果无法满足文文的需求，那么请输出`-1`

否则请输出在满足需求的情况下，文文最多能拍多少张照片。

注意每输出完一组数据之后，中间要空一行。

## 样例 #1

### 样例输入 #1
```
2 3
12 12 12
3 18
0 3 9
1 3 9
2 3 9
3 18
0 3 9
1 3 9
2 3 9
```

### 样例输出 #1

```
36
```

## 样例 #2

### 样例输入 #2
```
2 3
12 12 12
3 18
0 3 9
1 3 9
2 3 9
3 18
0 3 9
1 3 9
2 3 9
2 3
12 12 12
3 18
0 3 9
1 3 9
2 3 9
3 18
0 3 9
1 3 9
2 3 9
```

### 样例输出 #2

```
36

36
```

## 提示


