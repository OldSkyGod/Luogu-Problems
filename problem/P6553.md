# Strings of Monody

## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/tcsfyv6l.png)

LGD 是一只喜欢 Monody 的小恐龙。

根据 Monody 的音乐，他建立了一个模型，叫做 赞歌字符串。简称， SoM (String of Monody)。


## 题目描述

赞歌字符串是一个由 $1,4,5$ 组成的字符串。每次操作 LsWn 会拿出左端点为 $l$，右端点为 $r$ 的子串，（注意，第一个字符的下标为 $1$，最后一个字符的下标为 $n$）并把它替换为新的给出的子串。替换之后，你需要回答 $3$ 个对于完整串的问询，分别是：  
1. $1$ 的个数。  
2. 整个字符串每个数位的总和。  
3. 整个字符串每个数位的乘积。

所有输出都要对 $\color{black}998\color{red}24\color{black}353$ 取模。  



## 输入格式

第一行一个字符串。    
第二行一个数字 $m$ 代表有 $m$ 次操作  
后面 $m$ 行每行两个数字 $l,r$，然后一个长 $r-l+1$ 的字符串代表把 $(l,r)$ 子串改为这个字符串。   


## 输出格式

$m$ 行，每行 $3$ 个数，代表每次修改后的 $3$ 个问询。

## 样例 #1

### 样例输入 #1
```
114514
3
1 3 111  
3 4 44
4 4 5```

### 样例输出 #1

```
4 13 20
3 15 64
3 16 80```

## 提示

样例一的解释：  

第一次操作，字符串变为 ```111514``` ，其中 $1$ 的个数为 $4$，和为 $1+1+1+5+1+4=13$，乘积为 $1\times 1\times 1\times 1\times 5\times 1\times 4=20$。   
第二次操作，字符串变为 ```114414```。   
第三次操作，字符串变为 ```114514```。  

---

我们设初始字符串长度为 $n$。  

对于 $10\%$ 的数据，$n\le 10$。   
对于 $40\%$ 的数据，$n\le 1000$。  
对于全部数据，$n\le 10^6, m\le 10^3, 1\le r-l+1\le 10^3$。


---

update：出题人心血来潮，在 2021/02/08 把时间压到了 100 ms，为 std 用时的 6 倍左右。
