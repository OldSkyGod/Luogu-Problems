# [CTSC2000]逻辑范式

## 题目描述

逻辑学是对命题以及命题真假性进行研究的一门科学。命题一般用一个小写字母表示，任何命题的值非真即假。我们用 ```T``` 表示命题的值为真，用 ```F``` 表示命题的值为假。

命题间的运算符称为命题操作联结词，简称联结词。逻辑系统中最基本的三个联结词是非、且和或，为了简便，我们用 $!$ 表示联结词非，用 $\&$ 表示联结词且，用 $|$ 表示联结词或。

联结词非是一个一元联结词，对于任意命题 $p$ ，$!p$ 的真值总是和 $p$ 相反。

联结词且又称合取，是一个二元联结词，对于任意命题 $p$ 和 $q$ ，当且仅当 $p$ 和 $q$ 同为真时， $p\&q$ 为真，否则 $p\&q$ 为假。

联结词或又称析取，是一个二元联结词，对于任意命题 $p$ 和 $q$ ，当且仅当 $p$ 和 $q$ 同为假时， $p|q$ 为假，否则 $p|q$ 为真。

下面给出三个基本命题运算联结词的真值表：

| 命题 $p$ | 命题 $q$ | $!p$ | $p\&q$ | $p$\|$q$   |
| :----------: | :----------: | :----------: | :----------: | :----------: |
| T | T | F | T | T |
| T | F | F | F | T | 
| F | T | T | F | T |
| F | T | T | F | T |
| F | F | T | F | F | 


逻辑表达式是由命题、联结词和括号组成的。它的定义如下：

```<表达式>      ::=<合取式> or <析取式> or (<表达式>) or <元素>```

```<合取式>      ::=<表达式>&<表达式>```

```<析取式>      ::=<表达式>|<表达式>```

```<元素>      ::=[!]<命题>```

注：其中 <命题> 是 $a$ 到 $z$ 的小写字母，```::=``` 表示定义为， ```or``` 表示或， ```[]``` 内的项可以出现一次或不出现。

对表达式的求值过程是根据表达式中各命题的值和真值表进行命题运算操作的过程。运算优先级为 $()$ 、 $!$ 、 $\&$ 和 $|$ 。$\&$ 和 $|$ 的优先级相同。相同优先级从左到右运算。

与或非逻辑范式（这里简称为范式）是一种逻辑表达式，它能够符合特定的真值表。例如一般逻辑里定义的蕴涵运算 $\rightarrow$ 的真值表为：

| 命题 $p$ | 命题 $q$ | $p \rightarrow q$ |
| :----------: | :----------: | :----------: |
| T | T | T |
| T | F | F |
| F | T | T |
| F | F | F |


我们可以用表达式 $!p|q$ 来表示这个蕴涵运算。表达式  $!p|q$ 的真值表为：

| 命题 $p$ | 命题 $q$ | $!p$\|$q$ |
| :----------: | :----------: | :----------: |
| T | T | T |
| T | F | F |
| F | T | T |
| F | F | F |

这样，我们就说 $p→q$ 的范式为 $!p|q$ 。

完备定理告诉我们，对于任意一个 $n$ 元逻辑运算函数 $A$ ，已知 $A$ 的真值表，总可以求出 $A$ 的范式。范式只含命题、三个基本联结词和括号。例如，下面是一个三元运算 $A(p,q,r)$ 的真值表：

| 命题 $p$ | 命题 $q$ | 命题 $r$ | $A(p,q,r)$ |
| :----------: | :----------: | :----------: | :----------: |
| T | T | T | T |
| T | T | F | T |
| T | F | T | T |
| T | F | F | F |
| F | T | T | T |
| F | T | F | F |
| F | F | T | F |
| F | F | F | F |

也就是说，在命题 $p,q,r$ 有两个或两个以上为真时， $A$ 为真；反之 $A$ 为假。

当然，范式并不是唯一的。假设存在一种 $A$ 的范式为 $(p\&q\&r)|(!p\&q\&r)|(p\&!q\&r)|(p\&q\&!r)$ ， 表达式 $(p\&q)|(q\&r)|(p\&r)$ 也是 $A$ 的范式，并且它的长度比前式更短。

我们的要求是：给定 $n$ 元函数 $A$ 的真值表，求 $A$ 的范式，并要求范式尽可能短。

## 输入格式

输入文件第一行为 $n$ ，表示 $A$ 是 $n$ 元函数。随后有 $2^n$ 行，每行为一个长度为 $n+1$ 的字符串。字符串仅包含字符 ```T``` 和 ```F``` 。前 $n$ 个依次表示第 $n$ 个命题的值，最后一个表示当 $n$ 个命题按此取值时 $A$ 的值。

## 输出格式

输出文件包含一行，为你给出的范式。命题依次用小写字母 $a$ , $b$ , $c$ , $d$ ...表示。

## 样例 #1

### 样例输入 #1
```
3
TTTT
TTFT
TFTT
TFFF
FTTT
FTFF
FFTF
FFFF
```

### 样例输出 #1

```
a&b|(a|b&c)
```

## 提示

$n \leq 6$。

**评分标准**：

如果你给定的范式错误或者在规定时间内没有出解，该测试点得 $0$ 分。

如果你给定的范式长度小于等于标准答案的长度，该测试点得满分。

如果你给定的范式长度大于等于标准答案长度的两倍，该测试点得 $0$ 分。

如果你给定的范式长度大于标准答案的长度，小于标准答案长度的两倍，该测试
点得分计算公式为： 

$Score=FullScore \times \frac{2L_{std}-L}{L_{std}} $

其中 $FullScore$ 为该测试点满分， $L_{std}$ 为标准答案长度， $L$ 为你的答案长度。

**感谢 [tiger2005](https://www.luogu.com.cn/user/60864) 提供 SPJ ！**

