# [清华集训2016] 温暖会指引我们前行

## 题目描述

虽然小 R 住的宿舍楼早已来了暖气，但是由于某些原因，宿舍楼中的某些窗户仍然开着（例如厕所的窗户），这就使得宿舍楼中有一些路上的温度还是很低。

小 R 的宿舍楼中有 $n$ 个地点和一些路，一条路连接了两个地点，小 R 可以通过这条路从其中任意一个地点到达另外一个地点。但在刚开始，小 R 还不熟悉宿舍楼中的任何一条路，所以他会慢慢地发现这些路，他在发现一条路时还会知道这条路的温度和长度。每条路的温度都是互不相同的。

小 R 需要在宿舍楼中活动，每次他都需要从一个地点到达另一个地点。小 R 希望每次活动时经过一条最温暖的路径，最温暖的路径的定义为，将路径上各条路的温度从小到大排序后字典序最大。即温度最低的路温度尽量高，在满足该条件的情况下，温度第二低的路温度尽量高，以此类推。小 R 不会经过重复的路。由于每条路的温度互不相同，因此只存在一条最温暖的路径。

对于小 R 的每次活动，你需要求出小 R 需要走过的路径总长度。如果小 R 通过当前发现的路不能完成这次活动，则输出  `−1`。

注意本题中的字典序与传统意义上的字典序定义有所不同，对于两个序列 $a,b(a≠b)$，若 $a$ 是 $b$ 的前缀则 $a$ 的字典序较大，同时可以推出空串的字典序最大。

## 输入格式

第一行两个正整数 $n,m$。表示小 R 的宿舍楼中有 $n$ 个地点，共发生了 $m$ 个事件。

接下来 $m$ 行，每行描述一个事件，事件分为三类。

- `find id u v t l` 表示小 R 发现了一条连接 $u$ 和 $v$ 之间的路，编号为id。相同id的边只会出现一次。
- `move u v` 表示小 R 要从 $u$ 到达 $v$，你需要计算出最温暖的路径的长度 ，若不能从 $u$ 到达 $v$，则输出 `−1`。
- `change id l` 表示从 $u$ 到 $v$ 这条边的长度变为了 $l$（保证在当前时间点这条边存在）。



## 输出格式

对于每个询问，输出一行整数，表示最温暖的路径长度。

## 样例 #1

### 样例输入 #1
```
8 19
find 0 0 2 7 2
find 1 2 4 4 4
find 2 4 6 10 1
find 3 6 7 8 6
move 2 7
move 1 6
find 4 2 5 3 4
move 0 5
change 0 12
find 5 4 5 5 10
find 6 2 3 6 9
move 3 5
find 7 0 1 12 1
move 1 6
find 8 1 7 11 100
move 1 6
move 3 7
move 5 6
move 2 2
```

### 样例输出 #1

```
11
-1
6
23
18
106
122
11
0
```

## 样例 #2

### 样例输入 #2
```
15 45
find 0 1 0 8 5987
find 1 2 0 14 5455
find 2 3 0 27 8830
find 3 4 3 42 7688
find 4 5 0 25 1756
find 5 6 5 35 1550
find 6 7 4 43 9440
move 3 9
change 2 9113
move 10 13
move 3 3
move 11 10
find 7 8 7 6 7347
find 8 9 8 26 8935
move 8 4
change 3 4466
find 9 10 9 28 8560
move 6 5
find 10 11 10 31 6205
change 9 9228
find 11 12 10 23 948
find 12 13 12 45 5945
move 0 9
move 2 5
change 2 6118
find 13 14 13 12 6906
move 4 1
change 2 504
find 14 4 2 22 9796
move 10 7
move 1 14
move 13 3
find 15 12 9 39 8985
find 16 9 8 17 3710
change 1 5370
find 17 1 0 36 4669
find 18 7 6 37 8087
move 9 0
find 19 14 9 33 8234
find 20 0 4 24 5209
change 1 4883
find 21 6 3 9 2461
find 22 5 2 19 4291
change 1 7219
change 6 4846
```

### 样例输出 #2

```
-1
-1
0
-1
16787
1550
39301
7211
16571
25510
59706
46309
30692
```

## 提示

对于 `find` 操作：$0≤id<m$，$0≤u,v<n$，$u≠v$，$0≤t≤1000000000$，$0≤l≤10000$；

对于 `move` 操作：$0≤u,v<n$；

对于 `change` 操作：$0≤l≤10000$。

对于 $100\%$ 的数据，$1≤n≤100000$，$1≤m≤300000$。
